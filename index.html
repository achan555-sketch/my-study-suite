<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸŽ€ GRX Pro: Mega Board v16 ðŸŽ€</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700&family=Roboto+Mono:wght@500;700&display=swap');
        :root { 
            --p-light: #ffe5ec; --p-main: #ff8fab; --p-dark: #fb6f92; --bg: #0a0a0a; --card: #1a1a1a;
            --up: #ff3131; --down: #00e676; --text: #ffffff;
        }
        
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: var(--bg); font-family: 'Quicksand', sans-serif; color: var(--text); }
        
        /* Start Screen */
        #start-overlay { position: fixed; inset: 0; background: #fff0f3; z-index: 2000; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #5c4d50; }
        .input-name { padding: 18px; border-radius: 20px; border: 4px solid var(--p-light); width: 320px; font-size: 1.5rem; text-align: center; margin-bottom: 25px; outline: none; }
        .start-btn { background: var(--p-dark); color: white; border: none; padding: 15px 60px; border-radius: 20px; cursor: pointer; font-weight: 700; font-size: 1.5rem; }

        /* Main Grid: 50% | 50% */
        .main-container { display: flex; width: 100vw; height: 100vh; padding: 10px; box-sizing: border-box; gap: 10px; }
        
        /* LEFT: Charts */
        .left-panel { flex: 0 0 50%; display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; gap: 8px; }
        .chart-box { background: #000; border-radius: 15px; padding: 8px; border: 2px solid #333; display: flex; flex-direction: column; position: relative; }
        .chart-label { color: #888; font-size: 0.65rem; font-weight: bold; position: absolute; top: 10px; left: 12px; z-index: 5; }
        canvas { width: 100%; height: 100%; border-radius: 8px; }

        /* RIGHT: Mega Control Panel */
        .right-panel { flex: 0 0 50%; display: flex; flex-direction: column; gap: 10px; overflow: hidden; }
        .card { background: var(--card); border-radius: 20px; padding: 15px; border: 1px solid #333; }
        
        /* Asset Stats */
        .stats-card { display: flex; justify-content: space-between; align-items: center; padding: 10px 20px; border-bottom: 4px solid var(--p-main); }
        .total-asset { font-size: 1.8rem; font-weight: 700; color: var(--p-main); font-family: 'Roboto Mono'; }
        .rank-badge { padding: 4px 12px; border-radius: 8px; font-size: 0.7rem; font-weight: bold; color: white; text-transform: uppercase; }

        /* MEGA ORDER BOOK (The Star) */
        .board-card { background: #000; font-family: 'Roboto Mono'; flex-grow: 1; display: flex; flex-direction: column; padding: 10px; overflow: hidden; border: 3px solid #222; border-radius: 20px; }
        .board-header { display: flex; justify-content: space-between; color: #444; font-size: 0.7rem; padding-bottom: 5px; border-bottom: 1px solid #222; margin-bottom: 5px; }
        .board-row { display: flex; justify-content: space-between; height: 22px; align-items: center; font-size: 0.95rem; }
        .ask-price { color: var(--up); font-weight: bold; }
        .bid-price { color: var(--down); font-weight: bold; }
        .qty-val { color: #888; }
        
        /* HUGE Mid Price */
        .mid-price-line { background: #1a1a1a; text-align: center; padding: 10px; border: 2px solid #444; margin: 8px 0; border-radius: 15px; position: relative; }
        .mid-price-label { font-size: 0.6rem; color: #666; position: absolute; top: 5px; left: 15px; }
        .mid-val { font-size: 2.2rem; font-weight: bold; color: #fff; line-height: 1; }

        /* Trade Controls */
        .trade-card { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .btn { border: none; padding: 15px; border-radius: 15px; font-weight: 700; cursor: pointer; color: white; font-family: 'Quicksand'; font-size: 1rem; }
        .btn:active { transform: scale(0.96); }
        .btn-buy { background: var(--up); }
        .btn-sell { background: var(--down); }
        .btn-max { background: #333; grid-column: span 1; padding: 8px; font-size: 0.75rem; color: #aaa; }

        /* Ranking */
        .ranking-card { font-size: 0.8rem; background: #0a0a0a; border-radius: 20px; max-height: 110px; overflow: hidden; }
        .rank-row { display: flex; justify-content: space-between; padding: 4px 10px; border-bottom: 1px solid #1a1a1a; }
        .rank-row.me { color: var(--p-main); font-weight: bold; background: rgba(255, 143, 171, 0.15); border-radius: 5px; }
    </style>
</head>
<body>

<div id="start-overlay">
    <span style="font-size:4rem;">ðŸŽ€</span>
    <h1>GLOBAL RIBBON EXCHANGE</h1>
    <input type="text" id="user-name-input" class="input-name" placeholder="Trader Name" maxlength="10">
    <button class="start-btn" onclick="startGame()">OPEN MARKET ðŸš€</button>
</div>

<div class="main-container">
    <div class="left-panel">
        <div class="chart-box"><span class="chart-label">5M ENTRY</span><canvas id="chart5m"></canvas></div>
        <div class="chart-box"><span class="chart-label">1H SHORT</span><canvas id="chart1h"></canvas></div>
        <div class="chart-box"><span class="chart-label">DAILY MID</span><canvas id="chartDaily"></canvas></div>
        <div class="chart-box"><span class="chart-label">WEEKLY LONG</span><canvas id="chartWeekly"></canvas></div>
    </div>

    <div class="right-panel">
        <div class="card stats-card">
            <div style="text-align:left;">
                <div id="player-name" style="font-size:0.7rem; font-weight:700; opacity:0.6;">TRADER: achan</div>
                <div class="total-asset"><span id="total-val">100,000</span> <small style="font-size:0.6rem;">GRB</small></div>
            </div>
            <div id="rank-display" class="rank-badge">BRONZE</div>
        </div>

        <div class="card board-card">
            <div class="board-header"><span>PRICE</span><span>QTY</span></div>
            <div id="ask-rows"></div>
            
            <div class="mid-price-line">
                <span class="mid-price-label">LAST PRICE</span>
                <span class="mid-val" id="mid-val-display">100.00</span>
            </div>
            
            <div id="bid-rows"></div>
        </div>

        <div class="card trade-card">
            <button class="btn btn-buy" onclick="trade('buy', 1)">BUY 1</button>
            <button class="btn btn-sell" id="s1" onclick="trade('sell', 1)">SELL 1</button>
            <button class="btn btn-max" style="background:var(--up); opacity:0.8;" onclick="trade('buy','max')">ALL IN</button>
            <button class="btn btn-max" id="smax" style="background:var(--down); opacity:0.8;" onclick="trade('sell','max')">EXIT ALL</button>
            <div style="grid-column: span 2; font-size:0.75rem; display:flex; justify-content:space-between; margin-top:5px; font-family:'Roboto Mono'; opacity:0.6;">
                <span>CASH: <span id="cash-val">100.0k</span></span>
                <span>HOLD: <span id="hold-val">0</span> ðŸŽ€</span>
            </div>
        </div>

        <div class="card ranking-card">
            <div id="ranking-list"></div>
        </div>
    </div>
</div>

<script>
    let userName = "achan";
    let price = 100, lastPrice = 100, MIN = 70, MAX = 130;
    let user = { cash: 100000, hold: 0 };
    let data5m = [], data1h = [], dataDaily = [], dataWeekly = [];
    let currentCandle = { o: price, h: price, l: price, c: price, ticks: 0 };

    function startGame() {
        userName = document.getElementById('user-name-input').value || "Trader";
        document.getElementById('player-name').innerText = `TRADER: ${userName}`;
        document.getElementById('start-overlay').style.display = 'none';
        
        for(let i=0; i<60; i++) {
            price = Math.max(MIN, Math.min(MAX, price + (Math.random()-0.5)*4));
            let c = {o:price, h:price+1, l:price-1, c:price};
            data5m.push(c); if(i%3===0) data1h.push(c); if(i%9===0) dataDaily.push(c); if(i%18===0) dataWeekly.push(c);
        }
        setInterval(updateMarket, 600);
    }

    function updateMarket() {
        lastPrice = price;
        let move = (Math.random() - 0.5) * 6;
        price = Math.max(MIN, Math.min(MAX, price + move));
        
        currentCandle.h = Math.max(currentCandle.h, price);
        currentCandle.l = Math.min(currentCandle.l, price);
        currentCandle.c = price;
        currentCandle.ticks++;

        if (currentCandle.ticks >= 4) {
            data5m.push({...currentCandle}); if(data5m.length>30) data5m.shift();
            if(data5m.length%3===0) { data1h.push({...currentCandle}); if(data1h.length>30) data1h.shift(); }
            if(data1h.length%3===0) { dataDaily.push({...currentCandle}); if(dataDaily.length>30) dataDaily.shift(); }
            if(dataDaily.length%3===0) { dataWeekly.push({...currentCandle}); if(dataWeekly.length>30) dataWeekly.shift(); }
            currentCandle = { o: price, h: price, l: price, c: price, ticks: 0 };
        }
        drawAllCharts(); drawBoard(); updateUI();
    }

    function drawCandles(id, data) {
        const c = document.getElementById(id); const ctx = c.getContext('2d');
        const w = c.width = c.offsetWidth * 2; const h = c.height = c.offsetHeight * 2;
        ctx.scale(2,2);
        const cw = w/2, ch = h/2;
        ctx.clearRect(0,0,cw,ch);
        ctx.strokeStyle = '#1a1a1a'; ctx.lineWidth = 1;
        for(let i=1; i<8; i++) { let y = (ch / 8) * i; ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(cw, y); ctx.stroke(); }
        const space = cw / 32;
        const getY = (val) => ch - ((val - 68) / (132 - 68)) * ch;
        data.forEach((d, i) => {
            const x = i * space + space;
            const up = d.c >= d.o;
            const color = up ? '#ff3131' : '#00e676';
            ctx.strokeStyle = color; ctx.lineWidth = 1.5;
            ctx.beginPath(); ctx.moveTo(x, getY(d.h)); ctx.lineTo(x, getY(d.l)); ctx.stroke();
            ctx.fillStyle = color;
            const rectY = getY(Math.max(d.o, d.c));
            const rectH = Math.max(3, Math.abs(getY(d.o) - getY(d.c)));
            ctx.fillRect(x - 4, rectY, 8, rectH);
        });
    }

    function drawAllCharts() {
        drawCandles('chart5m', data5m); drawCandles('chart1h', data1h);
        drawCandles('chartDaily', dataDaily); drawCandles('chartWeekly', dataWeekly);
    }

    function drawBoard() {
        const askA = document.getElementById('ask-rows');
        const bidA = document.getElementById('bid-rows');
        const midA = document.getElementById('mid-val-display');
        
        let askH = '', bidH = '';
        for(let i=8; i>=1; i--) {
            let p = (price + i*0.2).toFixed(2);
            let q = Math.floor(Math.random()*900 + 100);
            askH += `<div class="board-row"><span class="ask-price">${p}</span><span class="qty-val">${q}</span></div>`;
        }
        for(let i=1; i<=8; i++) {
            let p = (price - i*0.2).toFixed(2);
            let q = Math.floor(Math.random()*900 + 100);
            bidH += `<div class="board-row"><span class="bid-price">${p}</span><span class="qty-val">${q}</span></div>`;
        }
        askA.innerHTML = askH;
        bidA.innerHTML = bidH;
        midA.innerText = price.toFixed(2);
        midA.style.color = price >= lastPrice ? 'var(--up)' : 'var(--down)';
    }

    function trade(type, amt) {
        if (type === 'buy') {
            let qty = (amt === 'max') ? Math.floor(user.cash / price) : amt;
            if (user.cash >= price * qty && qty > 0) { user.cash -= price * qty; user.hold += qty; }
        } else {
            let qty = (amt === 'max') ? user.hold : amt;
            if (user.hold >= qty && qty > 0) { user.hold -= qty; user.cash += price * qty; }
        }
        updateUI();
    }

    function updateUI() {
        const total = user.cash + (user.hold * price);
        document.getElementById('total-val').innerText = Math.floor(total).toLocaleString();
        document.getElementById('cash-val').innerText = (user.cash/1000).toFixed(1) + 'k';
        document.getElementById('hold-val').innerText = user.hold;

        let rank = "BRONZE", color = "#cd7f32";
        if (total >= 1000000) { rank = "PLATINUM"; color = "#e5e4e2"; }
        else if (total >= 500000) { rank = "GOLD"; color = "#ffd700"; }
        else if (total >= 200000) { rank = "SILVER"; color = "#c0c0c0"; }
        
        const rEl = document.getElementById('rank-display');
        rEl.innerText = rank; rEl.style.background = color;

        const leaders = [
            {n: "Elon Musk ðŸš€", a: 21000000}, {n: "Warren Buffett ðŸ“ˆ", a: 15000000},
            {n: "Jeff Bezos ðŸ“¦", a: 9500000}, {n: userName, a: total, me: true}, {n: "Jensen Huang ðŸ¤–", a: 450000}
        ].sort((a,b) => b.a - a.a);

        let listH = '';
        leaders.forEach((l, i) => {
            listH += `<div class="rank-row ${l.me?'me':''}"><span>${i+1}. ${l.n}</span><span>${Math.floor(l.a).toLocaleString()}</span></div>`;
        });
        document.getElementById('ranking-list').innerHTML = listH;

        document.getElementById('s1').disabled = user.hold < 1;
        document.getElementById('smax').disabled = user.hold < 1;
    }
</script>
</body>
</html>
