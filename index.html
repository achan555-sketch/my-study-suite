<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸŽ€ Pinky Trade School v8 ðŸŽ€</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700&family=Roboto+Mono:wght@500&display=swap');
        :root { --p-light: #ffe5ec; --p-main: #ff8fab; --p-dark: #fb6f92; --bg: #fff0f3; --text: #5c4d50; --ask: #ff4757; --bid: #2ed573; }
        
        body { background: var(--bg); color: var(--text); font-family: 'Quicksand', sans-serif; margin: 0; padding: 10px; display: flex; justify-content: center; min-height: 100vh; box-sizing: border-box; }
        .wrapper { width: 100%; max-width: 600px; display: flex; flex-direction: column; gap: 10px; }
        
        /* 4-Chart Grid */
        .chart-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; background: #111; padding: 10px; border-radius: 25px; border: 4px solid white; }
        .chart-box { text-align: center; }
        .chart-label { color: var(--p-light); font-size: 0.6rem; font-weight: bold; margin-bottom: 2px; text-transform: uppercase; }
        canvas { width: 100%; height: 70px; background: #000; border-radius: 10px; }

        /* Board */
        .board-card { background: #111; border-radius: 25px; padding: 12px; font-family: 'Roboto Mono'; font-size: 0.7rem; color: #eee; border: 4px solid white; }
        .mid-price-zone { background: #222; text-align: center; padding: 5px; margin: 5px 0; border-radius: 12px; border: 1px solid #444; }
        .mid-val { font-size: 1.1rem; font-weight: bold; color: var(--p-main); }
        .board-row { display: flex; justify-content: space-between; padding: 1px 5px; }

        /* Battle Zone */
        .battle-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .player-card { background: white; border-radius: 30px; padding: 15px; border: 3px solid var(--p-light); position: relative; text-align: center; transition: 0.3s; }
        .player-card.winning { border-color: var(--p-dark); box-shadow: 0 0 20px rgba(251,111,146,0.3); }
        .p-name { font-weight: 700; font-size: 0.8rem; color: var(--p-dark); }
        .p-asset { font-size: 1.2rem; font-weight: 700; margin: 5px 0; }
        
        .trade-btns { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }
        .btn { border: none; padding: 12px; border-radius: 15px; font-weight: 700; cursor: pointer; font-family: 'Quicksand'; font-size: 0.8rem; color: white; box-shadow: 0 4px 0 rgba(0,0,0,0.1); }
        .btn:active { transform: translateY(2px); box-shadow: none; }
        .btn-buy { background: var(--ask); }
        .btn-sell { background: var(--bid); }
        .btn-max { background: var(--p-light); color: var(--p-dark); grid-column: span 2; font-size: 0.7rem; padding: 6px; }
        .btn:disabled { opacity: 0.2; }

        .tips { font-size: 0.7rem; font-weight: 700; color: var(--p-dark); text-align: center; background: white; padding: 8px; border-radius: 15px; }
    </style>
</head>
<body>

<div class="wrapper">
    <div class="tips" id="market-tips">Welcome to Trading School! Buy when prices are low ðŸŒ¸</div>
    
    <div class="chart-grid">
        <div class="chart-box"><div class="chart-label">Weekly (Trend)</div><canvas id="chartWeekly"></canvas></div>
        <div class="chart-box"><div class="chart-label">Daily (Flow)</div><canvas id="chartDaily"></canvas></div>
        <div class="chart-box"><div class="chart-label">1 Hour (Focus)</div><canvas id="chart1h"></canvas></div>
        <div class="chart-box"><div class="chart-label">5 Min (Now)</div><canvas id="chart5m"></canvas></div>
    </div>

    <div class="board-card">
        <div id="ask-rows"></div>
        <div class="mid-price-zone">
            <span class="mid-val">Â¥<span id="cur-price">100</span></span>
        </div>
        <div id="bid-rows"></div>
    </div>

    <div class="battle-grid">
        <div class="player-card" id="card-p1">
            <div class="p-name">Student achan</div>
            <div class="p-asset">Â¥<span id="total-p1">100,000</span></div>
            <div class="trade-btns">
                <button class="btn btn-buy" onclick="trade(1,'buy',1)">Buy 1</button>
                <button class="btn btn-sell" id="s1-p1" onclick="trade(1,'sell',1)">Sell 1</button>
                <button class="btn btn-max" onclick="trade(1,'buy','max')">Buy MAX</button>
                <button class="btn btn-max" id="sm-p1" onclick="trade(1,'sell','max')">Sell ALL</button>
            </div>
        </div>
        <div class="player-card" id="card-p2">
            <div class="p-name">Student Rival</div>
            <div class="p-asset">Â¥<span id="total-p2">100,000</span></div>
            <div class="trade-btns">
                <button class="btn btn-buy" onclick="trade(2,'buy',1)">Buy 1</button>
                <button class="btn btn-sell" id="s1-p2" onclick="trade(2,'sell',1)">Sell 1</button>
                <button class="btn btn-max" onclick="trade(2,'buy','max')">Buy MAX</button>
                <button class="btn btn-max" id="sm-p2" onclick="trade(2,'sell','max')">Sell ALL</button>
            </div>
        </div>
    </div>
</div>

<script>
    let price = 100;
    const MIN = 70, MAX = 130;
    let p1 = { cash: 100000, hold: 0 }, p2 = { cash: 100000, hold: 0 };

    // Candle Data
    let data5m = [], data1h = [], dataDaily = [], dataWeekly = [];
    let currentCandle = { o: price, h: price, l: price, c: price, ticks: 0 };

    function updateMarket() {
        let move = (Math.random() - 0.5) * 8;
        if (Math.random() > 0.9) move *= 4;
        price = Math.max(MIN, Math.min(MAX, Math.floor(price + move)));

        currentCandle.h = Math.max(currentCandle.h, price);
        currentCandle.l = Math.min(currentCandle.l, price);
        currentCandle.c = price;
        currentCandle.ticks++;

        // Simulation Period Logic (Speed-up for game)
        if (currentCandle.ticks >= 3) { // 5m candle
            data5m.push({...currentCandle});
            if (data5m.length > 20) data5m.shift();
            
            if (data5m.length % 3 === 0) { // 1h candle
                data1h.push({o:data5m.slice(-3)[0].o, h:Math.max(...data5m.slice(-3).map(x=>x.h)), l:Math.min(...data5m.slice(-3).map(x=>x.l)), c:price});
                if (data1h.length > 20) data1h.shift();
            }
            if (data1h.length % 3 === 0 && data1h.length > 0) { // Daily
                dataDaily.push({o:data1h.slice(-3)[0].o, h:Math.max(...data1h.slice(-3).map(x=>x.h)), l:Math.min(...data1h.slice(-3).map(x=>x.l)), c:price});
                if (dataDaily.length > 20) dataDaily.shift();
            }
            if (dataDaily.length % 3 === 0 && dataDaily.length > 0) { // Weekly
                dataWeekly.push({o:dataDaily.slice(-3)[0].o, h:Math.max(...dataDaily.slice(-3).map(x=>x.h)), l:Math.min(...dataDaily.slice(-3).map(x=>x.l)), c:price});
                if (dataWeekly.length > 20) dataWeekly.shift();
            }
            currentCandle = { o: price, h: price, l: price, c: price, ticks: 0 };
        }

        drawAllCharts();
        drawBoard();
        updateUI();
        updateTips();
    }

    function drawCandles(id, data) {
        const c = document.getElementById(id); const ctx = c.getContext('2d');
        const w = c.width = c.offsetWidth; const h = c.height = c.offsetHeight;
        ctx.clearRect(0,0,w,h);
        const space = w / 22;
        data.forEach((d, i) => {
            const x = i * space + space;
            const getY = (val) => h - ((val - 68) / (132 - 68)) * h;
            ctx.strokeStyle = '#555'; ctx.beginPath(); ctx.moveTo(x, getY(d.h)); ctx.lineTo(x, getY(d.l)); ctx.stroke();
            ctx.fillStyle = d.c >= d.o ? '#fb6f92' : '#777';
            const rectY = getY(Math.max(d.o, d.c));
            const rectH = Math.max(2, Math.abs(getY(d.o) - getY(d.c)));
            ctx.fillRect(x - 3, rectY, 6, rectH);
        });
    }

    function drawAllCharts() {
        drawCandles('chart5m', data5m); drawCandles('chart1h', data1h);
        drawCandles('chartDaily', dataDaily); drawCandles('chartWeekly', dataWeekly);
    }

    function drawBoard() {
        let askH = '', bidH = '';
        for(let i=10; i>=1; i--) askH += `<div class="board-row" style="color:var(--ask)"><span>Â¥${Math.min(MAX, price+i)}</span><span>${Math.floor(Math.random()*150)}</span></div>`;
        for(let i=1; i<=10; i++) bidH += `<div class="board-row" style="color:var(--bid)"><span>Â¥${Math.max(MIN, price-i)}</span><span>${Math.floor(Math.random()*150)}</span></div>`;
        document.getElementById('ask-rows').innerHTML = askH;
        document.getElementById('bid-rows').innerHTML = bidH;
        document.getElementById('cur-price').innerText = price;
    }

    function updateTips() {
        const tips = document.getElementById('market-tips');
        if (price >= 125) tips.innerText = "ðŸš¨ High price! Good time to sell? ðŸ’°";
        else if (price <= 75) tips.innerText = "ðŸ’Ž Low price! Time to buy the dip? âœ¨";
        else tips.innerText = "Keep watching the charts... ðŸŽ€";
    }

    function trade(pNum, type, amt) {
        let p = (pNum === 1) ? p1 : p2;
        if (type === 'buy') {
            let qty = (amt === 'max') ? Math.floor(p.cash / price) : amt;
            if (p.cash >= price * qty && qty > 0) { p.cash -= price * qty; p.hold += qty; }
        } else {
            let qty = (amt === 'max') ? p.hold : amt;
            if (p.hold >= qty && qty > 0) { p.cash += price * qty; p.hold -= qty; }
        }
        updateUI();
    }

    function updateUI() {
        const t1 = p1.cash + (p1.hold * price), t2 = p2.cash + (p2.hold * price);
        document.getElementById('total-p1').innerText = t1.toLocaleString();
        document.getElementById('total-p2').innerText = t2.toLocaleString();
        document.getElementById('card-p1').className = `player-card ${t1 > t2 ? 'winning' : ''}`;
        document.getElementById('card-p2').className = `player-card ${t2 > t1 ? 'winning' : ''}`;
        document.getElementById('s1-p1').disabled = p1.hold < 1;
        document.getElementById('sm-p1').disabled = p1.hold < 1;
        document.getElementById('s1-p2').disabled = p2.hold < 1;
        document.getElementById('sm-p2').disabled = p2.hold < 1;
    }

    setInterval(updateMarket, 600);
    window.onload = updateMarket;
</script>
</body>
</html>
